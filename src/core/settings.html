<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Hyena</title>
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"
        />
        <link rel="stylesheet" href="../index.css" />
    </head>
    <body>
        <div class="menu">
            <a href="../index.html"
                ><img style="height: 25px" src="../assets/home.png"
            /></a>
            <a onclick="window.close()"
                ><img style="height: 25px" src="../assets/close.png"
            /></a>
        </div>
        <span class="head tag is-large is-white"><img id="playerHead" /></span>
        <section class="section">
            <div class="container has-text-centered">
                <h1 class="title">
                    Hyena&nbsp;<span class="tag is-black is-large">UPD</span>
                </h1>
                <h2>UUID</h2>
                <input
                    id="uuid"
                    class="input is-normal"
                    type="text"
                    placeholder="Enter Player UUID"
                />
                <br /><br />
                <h2>MC Name</h2>
                <input
                    id="mcName"
                    class="input is-normal"
                    type="text"
                    placeholder="Player Username From UUID"
                    readonly
                />
                <br /><br />
                <h2>Mods Folder</h2>
                <input
                    id="modsDir"
                    class="input is-normal"
                    type="text"
                    placeholder="Enter Mods Directory"
                />
                <br /><br />
                <button
                    onclick="saveDataS1()"
                    class="button is-success is-outlined"
                >
                    Save
                </button>
                <button
                    onclick="setVanilla()"
                    class="button is-info is-outlined"
                >
                    Use Vanilla Launcher
                </button>
                <button
                    onclick="eraseData()"
                    class="button is-danger is is-outlined is-light"
                >
                    Erase
                </button>
            </div>
        </section>
        <script src="./settings.js"></script>
        <script>
            function setVanilla() {
                const modsDir = document.getElementById('modsDir')
                modsDir.value = path.join(
                    process.env.APPDATA,
                    '\\.minecraft',
                    '\\mods'
                )
            }

            async function saveDataS1() {
                const uuid = document.getElementById('uuid').value
                const modsDir = document.getElementById('modsDir').value
                await saveData(uuid, modsDir)
                //window.location.href = "../index.html"
            }

            const modsDirValue = localStorage.getItem('modsDir')
            const uuidValue = localStorage.getItem('uuid')

            if (modsDirValue) {
                document.getElementById('modsDir').value = modsDirValue
            }

            if (uuidValue) {
                document.getElementById('uuid').value = uuidValue
                getId(uuidValue).then((uuid) => {
                    if (uuid) {
                        console.log(`UUID: ${uuid}`)
                        const imageUrl =
                            'https://mc-heads.net/head/' + uuid + '/40'
                        document.getElementById('playerHead').src = imageUrl
                    } else {
                        console.log(
                            `UUID not found for playername "${uuidValue}".`
                        )
                    }
                })
            }

            async function getId(playername) {
                try {
                    const response = await fetch(
                        `https://api.minetools.eu/uuid/${playername}`
                    )
                    const data = await response.json()
                    const mcName = document.getElementById('mcName')
                    mcName.value = data.name
                    return data.id
                } catch (error) {
                    console.error('Error fetching UUID:', error)
                    return null
                }
            }

            function eraseData() {
                localStorage.clear()
                location.reload()
            }
        </script>
    </body>
</html>
